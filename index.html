
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discogs Collection with Firebase</title>
    <!-- Firebase compat scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDBHRLu_F4uH6Jp9FCPEcrfoKA9uItESD4",
            authDomain: "collection-sorter.firebaseapp.com",
            databaseURL: "https://collection-sorter-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "collection-sorter",
            storageBucket: "collection-sorter.firebasestorage.app",
            messagingSenderId: "102433980397",
            appId: "1:102433980397:web:86e118cfdb44fdfb5e71e4",
            measurementId: "G-K6EZQNEX61"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Listen for changes and update the table
        document.addEventListener('DOMContentLoaded', function () {
            const rows = document.querySelectorAll('#collectionTable tbody tr');
            rows.forEach((row, index) => {
                const statusCell = row.querySelector('td:nth-last-child(1) button');
                const ref = database.ref('records/' + index);

                // Sync changes from Firebase
                ref.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        statusCell.textContent = data.status;
                        statusCell.style.backgroundColor = data.status === "Simon" ? "blue" : "red";
                        statusCell.style.color = "white";
                    }
                });
            });
        });

        // Function to toggle status and save to Firebase
        function toggleStatus(button, rowIndex) {
            const ref = database.ref('records/' + rowIndex);
            ref.once('value', (snapshot) => {
                const currentStatus = snapshot.val();
                const newStatus = currentStatus === "Simon" ? "Lewis" : "Simon";

                // Update display
                button.textContent = newStatus;
                button.style.backgroundColor = newStatus === "Simon" ? "blue" : "red";
                button.style.color = "white";

                // Save update to Firebase
                ref.set(newStatus);
            });
        }
    </script>
</head>
<body>
    <h1>Discogs Collection with Firebase</h1>
    <table id="collectionTable" border="1">
        <thead>
            <tr>
                <th>Title</th>
                <th>Artist</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Record 1</td>
                <td>Artist A</td>
                <td><button onclick="toggleStatus(this, 0)" style="background-color: blue; color: white;">Simon</button></td>
            </tr>
            <tr>
                <td>Record 2</td>
                <td>Artist B</td>
                <td><button onclick="toggleStatus(this, 1)" style="background-color: red; color: white;">Lewis</button></td>
            </tr>
            <tr>
                <td>Record 3</td>
                <td>Artist C</td>
                <td><button onclick="toggleStatus(this, 2)" style="background-color: blue; color: white;">Simon</button></td>
            </tr>
            <tr>
                <td>Record 4</td>
                <td>Artist D</td>
                <td><button onclick="toggleStatus(this, 3)" style="background-color: red; color: white;">Lewis</button></td>
            </tr>
        </tbody>
    </table>
</body>
</html>
